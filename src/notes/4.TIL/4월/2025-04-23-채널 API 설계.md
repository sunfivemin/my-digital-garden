---
tags:
  - TIL
created: 2025-04-23
---

# 📘 2025-04-23 TIL

## 📌 오늘 배운 핵심 요약



## 🧠 상세 학습 내용

## 📍 주제 1:  로그인 고도화

### 1. 로그인 API (POST /login) 설계와 코드

#### 기본 아이디어
- 사용자가 로그인 폼에 userId, password를 입력하면,
- 서버에서 DB(Map) 전체를 순회하며 userId가 **실제로 존재하는지** 확인
- **존재하면** 비밀번호가 일치하는지 검증
- **둘 다 맞으면** 로그인 성공(회원 정보+환영 메시지 반환)
- **틀리면** 상황별 에러 메시지 반환

#### **API 설계**

| **기능** | **메서드/엔드포인트** | **요청(req)**            | **응답(res)**          |
| ------ | ------------- | ---------------------- | -------------------- |
| 로그인    | POST /login   | body: userId, password | 로그인 성공/실패 메시지, 회원 정보 |

#### **코드 예시**

```js
// 로그인 (POST /login)
exports.login = (req, res) => {
const { userId, password } = req.body;
let foundUser = null;

// 모든 회원 순회, 아이디/비번 일치 회원 찾기
userModel.getAllUsers().forEach((user) => {
	if (user.userId === userId && user.password === password) {
	foundUser = user;
	}
});

// foundUser가 있으면(로그인 성공), 없으면(실패)
if (isExisted(foundUser)) {
	// 로그인 성공
	res.status(200).json({ message: `${foundUser.name}님 환영합니다`, user: foundUser });
	} else {
	// 로그인 실패
	res.status(401).json({ message: "아이디 또는 비밀번호가 틀렸습니다." });
	}
};

// foundUser가 null/undefined가 아니고, 빈 객체도 아닐 때 true 반환
function isExisted(user) {
	return user && Object.keys(user).length !== 0;
}
```

- 핵심: DB의 모든 유저 정보를 돌면서 userId와 password를 체크, 상황별로 명확한 상태코드/메시지 제공

#### **💻**  로그인 흐름

### 1) userId 검사

```js
var loginUser = {};         // 로그인 시도한 회원 데이터 임시 저장용 변수

db.forEach(function(user, id) {
  if (user.userId === userId) {     // userId가 같은지 확인
    loginUser = user;               // 찾으면 임시 변수에 저장
  }
});
```

- db.forEach로 모든 회원 정보(객체)를 돌면서
- user.userId === userId인 동일 회원을 찾아서 loginUser에 저장
- 이 과정이 바로 “DB에서 해당 아이디가 존재하는지 확인” 단계

### 2) 비밀번호 검사

```js
if (loginUser) {
  if (loginUser.password === password) {
    // 로그인 성공!
    res.status(200).json({ message: `${loginUser.name}님 환영합니다!`, user: loginUser });
  } else {
    // 비밀번호 틀림!
    res.status(401).json({ message: "비밀번호가 틀렸습니다." });
  }
} else {
  // 아이디가 없음!
  res.status(401).json({ message: "존재하지 않는 아이디입니다." });
}
```

-  loginUser(즉, userId가 맞는 회원)가 있으면
- 비밀번호까지 일치하는지 === 로 한번 더 체크
- 둘 다 맞으면 “로그인 성공”
- userId만 맞고 password가 다르면 “비번 틀림”
- userId 자체가 없으면 “존재하지 않는 아이디” 안내

#### **실전에서 고려할 점**

- 실무에서는 **비밀번호는 평문 저장 금지** → bcrypt 등으로 암호화(해시) 필요
- 로그인 성공시 **JWT(토큰) 발급**으로 인증 처리


---
### 📌  자바스크립트 Object.keys()
빈 객체 확인하는 방법
1. 객체.Keys()
2. for in
3. lodash : isEmpty

---
## 📍 주제 2:   채널 API 설계

유튜브 채널 관리 프로젝트에서 “채널”이라는 리소스를 어떻게 CRUD(생성, 읽기, 수정, 삭제)로 설계할지 정리하였다.

### **1. 요구 기능 요약**
**마이페이지**    
- 회원 정보 조회 API
- 회원 탈퇴 API

**채널 관리 페이지**
- 전체 채널 목록 조회 API
- 채널 개별 수정/삭제 API
- 채널 생성 API

- 로그인한 유저만 채널 생성/수정/삭제 가능하게 확장 가능!
- (회원-채널 1:N 관계) 한 회원이 여러 채널을 가질 수 있음

| **기능** | **메서드/엔드포인트**            | **요청(req)**                     | **응답(res)** |
| ------ | ------------------------ | ------------------------------- | ----------- |
| 채널 생성  | POST /channels           | body: userId, channelTitle      | 채널 생성 메시지   |
| 채널 목록  | GET /channels?userId=xxx | query: userId                   | 해당 유저 채널 목록 |
| 채널 수정  | PUT /channels/:id        | params: id, body: channellTitle | 채널 수정 메시지   |
| 채널 삭제  | DELETE /channels/:id     | params: id                      | 채널 삭제 메시지   |
#### **코드 구조**

- /routes/channel.js, /controllers/channelController.js 등으로 분리해도 좋음
- 채널 데이터도 Map, 객체, 추후 DB(몽고DB 등)로 확장 가능


---
## 🚀 프로젝트 구조 (실전 흐름)


---
## **💭 회고**

• **새롭게 알게 된 점**
- 

• **어렵게 느껴졌던 부분**
- 

• **다음에 학습할 주제**
- 

---

## 🔗 참고 자료
